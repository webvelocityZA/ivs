<div class="w-full bg-gray-800 px-8 py-8 flex items-center">

  <div class="text-2xl">
    <span class="text-gray-200 font-light tracking-wide">Welcome,</span>
    <span class="text-gray-200 font-bold tracking-wide"> User</span>
    <p class="tracking-widest text-sm text-gray-200 font-normal mt-4">You are currently viewing from  </p>
  </div>

</div>

<div *ngIf="!isLoading" class="p-4 px-10 md:px-28">
  <mat-tab-group mat-align-tabs="center" [(selectedIndex)]="IVSTabIndex">
    <mat-tab [disabled]='IVSTabIndex < 0' label="Personal Details">
      <div class="py-4">
        <form #registerForm="ngForm" (submit)="registerPatient(registerForm)" class="mt-6">



          <div class="w-full md:w-full md:px-2 inline-block">
            <mat-form-field appearance="fill" hideRequiredMarker="false" floatLabel="Are you a GEMS member?">
              <mat-select required>
                <mat-option>Please Select</mat-option>
                <mat-option value="yes">Yes</mat-option>
                <mat-option value="no">No</mat-option>
              </mat-select>
              <mat-label>Are you a GEMS member?</mat-label>
            </mat-form-field>
          </div>


          <div class="w-full md:w-full md:px-2 inline-block">
            <mat-form-field appearance="fill">
              <mat-label>ID Number</mat-label>
              <input matInput placeholder="ID Number" name="idNumber" ngModel #idNumberInput="ngModel" required idNumber
                (ngModelChange)="checkIfIDExists($event)">
              <mat-icon *ngIf="userExists" class="text-green-600" matSuffix>sentiment_very_satisfied</mat-icon>
              <mat-error *ngIf="idNumberInput.hasError('required')">ID Number is required </mat-error>
              <!-- <mat-error *ngIf="idNumberInput.value?.length < 9">
                 {{idNumberInput.value?.length || 0}}  
                A valid Passport / South African ID should be not be less than 9 characters long</mat-error> -->
            </mat-form-field>
          </div>
          <div class="px-2" *ngIf="registered">
            <div class="w-full md:w-full md:px-2 inline-block p-4 bg-red-600">
              <span class="text-white">User already registered</span>
            </div>
          </div>

          




          <div class="w-full md:w-1/2 md:px-2 inline-block" *ngIf="!registered && isIDValid">
            <mat-form-field appearance="fill">
              <mat-label>First Name</mat-label>
              <input matInput placeholder="First Name" name="firstName" ngModel #firstNameInput="ngModel" required
                firstName [disabled]="userExists">
              <mat-icon matSuffix>perm_identity</mat-icon>
              <mat-error *ngIf="firstNameInput.hasError('required')">First Name is required</mat-error>
            </mat-form-field>
          </div>
          <div class="w-full md:w-1/2 md:px-2 inline-block" *ngIf="!registered && isIDValid">
            <mat-form-field appearance="fill">
              <mat-label>Last Name</mat-label>
              <input matInput placeholder="Last Name" name="lastName" ngModel #lastNameInput="ngModel" required lastName
                [disabled]="userExists">
              <mat-icon matSuffix>perm_identity</mat-icon>
              <mat-error *ngIf="lastNameInput.hasError('required')">Last Name is required</mat-error>
            </mat-form-field>
          </div>

          <div class="w-full md:w-1/2 md:px-2 inline-block" *ngIf="!registered && isIDValid">
            <mat-form-field appearance="fill">
              <mat-label>Select Location</mat-label>
              <input type="text" placeholder="Select your location" aria-label="Select your location" matInput
                [formControl]="myControl" [matAutocomplete]="auto">
              <mat-icon matSuffix>my_location</mat-icon>
              <mat-autocomplete autoActiveFirstOption #auto="matAutocomplete">
                <mat-option *ngFor="let option of filteredOptions | async" [value]="option.name">
                  {{option.name}}
                </mat-option>
              </mat-autocomplete>
            </mat-form-field>
          </div>



          <div class="w-full md:w-1/2 md:px-2 inline-block" *ngIf="!registered && isIDValid">
            <mat-form-field appearance="fill">
              <mat-label>Employer</mat-label>
              <input matInput placeholder="Employer" type="text" name="employer" ngModel #employerInput="ngModel"
                required employer [disabled]="userExists">
              <mat-icon matSuffix>perm_identity</mat-icon>
              <mat-error *ngIf="employerInput.hasError('required')">Employer is required</mat-error>
            </mat-form-field>
          </div>
          <div class="w-full md:w-1/2 md:px-2 inline-block" *ngIf="!registered && isIDValid">
            <mat-form-field appearance="fill">
              <mat-label>Position</mat-label>
              <input matInput placeholder="Position" type="text" name="position" ngModel #positionInput="ngModel"
                required position [disabled]="userExists">
              <mat-icon matSuffix>meeting_room</mat-icon>
              <mat-error *ngIf="positionInput.hasError('required')">Current Position is required</mat-error>
            </mat-form-field>
          </div>
          <!-- <div class="w-full md:w-1/2 md:px-2 inline-block">
            <mat-form-field appearance="fill">
              <mat-label>Medical Aid Number</mat-label>
              <input matInput placeholder="Medical Aid Number" min="0" name="medicalAidNumber" ngModel #medicalAidNumberInput="ngModel" required medical_aid_number [disabled]="userExists">
              <mat-icon matSuffix>local_hospital</mat-icon>
              <mat-error *ngIf="medicalAidNumberInput.hasError('required')">Medical Aid Number is required</mat-error>
            </mat-form-field>
          </div> -->

          <div class="w-full md:w-1/2 md:px-2 inline-block" *ngIf="!registered && isIDValid">
            <mat-form-field appearance="fill">
              <mat-label>Mobile Number</mat-label>
              <input matInput placeholder="Mobile Number" name="mobileNumber" ngModel #mobileNumberInput="ngModel"
                required mobileNumber [disabled]="userExists">
              <mat-icon matSuffix>phone</mat-icon>
              <mat-error *ngIf="mobileNumberInput.hasError('required')">Mobile number is required</mat-error>
            </mat-form-field>
          </div>


          <div class="w-full md:w-1/2 md:px-2 inline-block" *ngIf="!registered && isIDValid">
            <mat-form-field appearance="fill">
              <mat-label>Email Address</mat-label>
              <input matInput placeholder="Email Address" name="emailAdress" ngModel #emailAdressInput="ngModel"
                required emailAdress [disabled]="userExists">
              <mat-icon matSuffix>email</mat-icon>
              <mat-error *ngIf="emailAdressInput.hasError('required')">Email address is required</mat-error>
            </mat-form-field>
          </div>


          <div class="w-full md:w-1/2 md:px-2 inline-block" *ngIf="!registered && isIDValid">
            <mat-form-field appearance="fill">
              <mat-label>Scheme Name</mat-label>
              <input matInput placeholder="Scheme Name" name="schemeName" ngModel #schemeNameInput="ngModel" required
                schemeName [disabled]="userExists">
              <mat-icon matSuffix>perm_identity</mat-icon>
              <mat-error *ngIf="schemeNameInput.hasError('required')">Scheme Name is required</mat-error>
            </mat-form-field>
          </div>



        </form>
      </div>

      <div class="mx-2">
        <button *ngIf="!registered && isIDValid" mat-raised-button type="button" color="primary"
          (click)="checkValidation(registerForm)">Continue</button>
      </div>

    </mat-tab>
    <mat-tab [disabled]='IVSTabIndex < 1' label="Medical History">
      <mat-form-field appearance="fill" hideRequiredMarker="false" floatLabel="Allergies & Chronic Medication">
        <mat-select [(ngModel)]="allergies" (ngModelChange)="doesPatientHaveAllergies($event)" required>
          <mat-option>Please Select</mat-option>
          <mat-option value="yes">Yes</mat-option>
          <mat-option value="no">No</mat-option>
        </mat-select>
        <mat-label>Allergies & Chronic Medication</mat-label>
      </mat-form-field>

      <div class="w-full md:w-full block" *ngIf="allergies === 'yes'">
        <mat-form-field appearance="fill">
          <mat-label>Description</mat-label>
          <textarea matInput placeholder="Description" name="description" [(ngModel)]="allergiesDescription"></textarea>
          <!-- <mat-hint>Hint</mat-hint> -->
        </mat-form-field>
      </div>
      <div class="mx-2">
        <button mat-raised-button color="primary" (click)="registerPatient(registerForm)">Complete Registration</button>
      </div>
    </mat-tab>
    <!-- <mat-tab [disabled]='IVSTabIndex < 2' label="Personal Details">
      <button mat-raised-button color="accent" (click)="navToTab()">Tab Demo 1!</button>
    </mat-tab>
    <mat-tab [disabled]='IVSTabIndex < 3' label="Medical History">
      <button mat-raised-button color="accent" (click)="navToTab()">Tab Demo 1!</button>
    </mat-tab> -->
  </mat-tab-group>
</div>

<div class="h-screen w-full flex items-center justify-center" *ngIf="isLoading">
  <mat-spinner></mat-spinner>
</div>
